// ============================================================================
// DOPRI THREE-REGION POLYNOMIAL APPROXIMATION
// ============================================================================
//
// Pure DOPRI polynomials split into three regions to avoid zero-crossing
// All regions use adaptive DOPRI polynomial fitting
// No mixing with Taylor series or other methods - pure polynomial only
//
// Generated by generate_dopri_three_region.py
// ============================================================================

/**
 * @brief DOPRI Three Region Deg7
 *
 * Pure DOPRI polynomial approximation with three-region split
 * Degree: 7, Total segments: 80
 * Negative: [-13.5625, -0.125] (32 segs)
 * Near-zero: [-0.125, 0.125] (24 segs)
 * Positive: [0.125, 2.78125] (24 segs)
 */
std::bfloat16_t gelu_dopri_three_region_deg7(std::bfloat16_t x_bf16) {
    float x = static_cast<float>(x_bf16);

    // Saturation checks
    if (x >= 2.78125f) return static_cast<std::bfloat16_t>(x);
    if (x < -13.5625f) return static_cast<std::bfloat16_t>(0.0f);

    constexpr float breakpoints[] = {
        -13.56250000f, -7.31686179f, -7.30582840f, -7.30582840f, -6.94634650f,
        -6.75393482f, -6.53168430f, -6.31161037f, -6.09259875f, -5.86980652f,
        -5.62828482f, -5.41037016f, -5.19408718f, -4.98600653f, -4.78494876f,
        -4.59097935f, -4.40393754f, -4.22364728f, -0.57514364f, -0.53458922f,
        -0.49578356f, -0.45847521f, -0.42244771f, -0.38748650f, -0.35348564f,
        -0.32026968f, -0.28775098f, -0.25582617f, -0.22441419f, -0.19342373f,
        -0.16279369f, -0.13246493f, -0.12500000f, -0.11434235f, -0.10386465f,
        -0.09336491f, -0.08288315f, -0.07243848f, -0.06198328f, -0.05157593f,
        -0.04116658f, -0.03074471f, -0.02037209f, -0.00995821f, 0.00043337f,
        0.01080440f, 0.02114192f, 0.03148510f, 0.04184654f, 0.05218903f,
        0.06256637f, 0.07297255f, 0.08333967f, 0.09376278f, 0.10419660f,
        0.11464104f, 0.12500000f, 0.19457563f, 0.21802319f, 0.25650212f,
        0.29292841f, 0.33052772f, 0.36905777f, 0.40874767f, 0.44980800f,
        0.49250719f, 0.53717872f, 0.58425177f, 0.63429055f, 0.68808260f,
        0.74673629f, 0.81197095f, 0.88661249f, 0.97597030f, 1.09218704f,
        1.18094884f, 1.18094884f, 1.24735486f, 1.29103530f, 1.35525651f,
        2.78125000f
    };

    constexpr float coeffs[80][8] = {
        { -2.434400791327e-08f, -1.660184838077e-08f, -4.818531137543e-09f, -7.716185276383e-10f, -7.363548403796e-11f, -4.188139958196e-12f, -1.314747943168e-13f, -1.757580369599e-15f },
        { -8.664944085308e-13f, 3.588470961572e-12f, -1.292584276681e-11f, 3.668090749467e-11f, -6.093814453158e-11f, -2.938856104002e-11f, -4.220528764262e-12f, -1.968811768386e-13f },
        { -8.003226376466e-25f, 5.847019859062e-24f, -4.271732376982e-23f, 3.120854373731e-22f, -2.280042653074e-21f, 1.665760037891e-20f, -1.216975700035e-19f, 8.891015637225e-19f },
        { -6.794128717001e-08f, 1.259360376955e-07f, -1.068062515503e-07f, -1.150396616720e-07f, -3.569799656541e-08f, -5.197406340907e-09f, -3.695350633723e-10f, -1.039156306039e-11f },
        { -1.647282814742e-09f, 4.691592291116e-09f, -1.006086964217e-08f, 1.115122961679e-08f, 8.712796839909e-09f, 2.044950314677e-09f, 2.035988342188e-10f, 7.468718462428e-12f },
        { -1.136571953031e-06f, 1.934600153178e-06f, -1.419237421897e-06f, -1.790518738208e-06f, -6.051005338268e-07f, -9.496953542150e-08f, -7.254107861166e-09f, -2.188172599352e-10f },
        { -3.871630755209e-06f, 6.304042045215e-06f, -4.288534704506e-06f, -5.885981120634e-06f, -2.074548574322e-06f, -3.377194265351e-07f, -2.670827127530e-08f, -8.334595775455e-10f },
        { -1.224715223156e-05f, 1.907325602665e-05f, -1.190151869875e-05f, -1.794927581844e-05f, -6.608639879707e-06f, -1.116956571014e-06f, -9.152742184452e-08f, -2.956883903188e-09f },
        { -3.684720148676e-05f, 5.474785087589e-05f, -3.092367832511e-05f, -5.196197569632e-05f, -2.003634708422e-05f, -3.522003599177e-06f, -2.994934976806e-07f, -1.003075173695e-08f },
        { -1.102518864590e-04f, 1.552321228421e-04f, -7.771274715487e-05f, -1.489334747200e-04f, -6.044242924814e-05f, -1.109075926758e-05f, -9.819468679135e-07f, -3.420433438299e-08f },
        { -3.039226107053e-04f, 4.044097044769e-04f, -1.752524337716e-04f, -3.925515886285e-04f, -1.680974914274e-04f, -3.224567012522e-05f, -2.976187044910e-06f, -1.079437873815e-07f },
        { -7.475595100741e-04f, 9.391385441693e-04f, -3.436976288003e-04f, -9.229247311771e-04f, -4.170553144896e-04f, -8.358464140944e-05f, -8.036065242667e-06f, -3.032289323845e-07f },
        { -1.699394115410e-03f, 2.009330792968e-03f, -5.942408265783e-04f, -2.001480598048e-03f, -9.563562050142e-04f, -2.004265300188e-04f, -2.008500537070e-05f, -7.889086908462e-07f },
        { -3.550049785654e-03f, 3.940193313648e-03f, -8.785548021556e-04f, -3.982183718140e-03f, -2.014814763397e-03f, -4.416555203064e-04f, -4.613321319980e-05f, -1.886178186340e-06f },
        { -6.861551950062e-03f, 7.126310777174e-03f, -1.046988612536e-03f, -7.315833453174e-03f, -3.925596227539e-03f, -9.003093309482e-04f, -9.802973088519e-05f, -4.171939739838e-06f },
        { -1.232988956120e-02f, 1.193911584265e-02f, -7.987159726553e-04f, -1.246583887471e-02f, -7.105426807094e-03f, -1.705291852224e-03f, -1.935455942169e-04f, -8.573039651903e-06f },
        { -2.069900733545e-02f, 1.861222648319e-02f, 3.363515368879e-04f, -1.978969038020e-02f, -1.200237586627e-02f, -3.014713087291e-03f, -3.566099338122e-04f, -1.643773964496e-05f },
        { 2.999213195539e-02f, 6.390647333865e-01f, 6.404556454117e-01f, 1.870377992553e-01f, -2.182420402793e-02f, -2.331597847324e-02f, -4.691744401371e-03f, -3.160379798691e-04f },
        { -3.551561905875e-05f, 4.995568656068e-01f, 3.965891617151e-01f, -6.853498584875e-03f, -7.815069962779e-02f, -1.111365102314e-02f, 5.485417851145e-03f, 9.460757121808e-04f },
        { -1.649924548576e-05f, 4.997801011240e-01f, 3.976985253021e-01f, -3.838535833043e-03f, -7.333529735614e-02f, -6.628971160399e-03f, 7.710926987525e-03f, 1.388845863845e-03f },
        { -6.420451827323e-06f, 4.999085763946e-01f, 3.983931259915e-01f, -1.779289864929e-03f, -6.973345698691e-02f, -2.932893544270e-03f, 9.752921218392e-03f, 1.850201657379e-03f },
        { -1.720269791601e-06f, 4.999743099426e-01f, 3.987841073564e-01f, -4.993399920485e-04f, -6.724842576432e-02f, -8.062209376514e-05f, 1.153666960422e-02f, 2.315743993143e-03f },
        { -3.880787744061e-08f, 5.000007308755e-01f, 3.989617151201e-01f, 1.626780449846e-04f, -6.577093487339e-02f, 1.893377245716e-03f, 1.299824712705e-02f, 2.778275522968e-03f },
        { 4.619981563554e-07f, 5.000095655841e-01f, 3.990287816214e-01f, 4.467450035824e-04f, -6.504574547921e-02f, 3.009387526033e-03f, 1.395697388340e-02f, 3.132966366708e-03f },
        { 3.903064846528e-07f, 5.000087052743e-01f, 3.990264680953e-01f, 4.605659747908e-04f, -6.493302693737e-02f, 3.332307304796e-03f, 1.439224566400e-02f, 3.364594936202e-03f },
        { 2.499286330027e-07f, 5.000060038969e-01f, 3.990047530052e-01f, 3.670611339227e-04f, -6.516144239621e-02f, 3.028590724756e-03f, 1.421099313370e-02f, 3.346492193140e-03f },
        { 9.957715608555e-08f, 5.000027141225e-01f, 3.989742966760e-01f, 2.130238615939e-04f, -6.561837386219e-02f, 2.241160551207e-03f, 1.349318002420e-02f, 3.088340721761e-03f },
        { 3.452604869509e-08f, 5.000010217270e-01f, 3.989554291781e-01f, 9.614349475628e-05f, -6.605307169042e-02f, 1.270042826120e-03f, 1.228582462046e-02f, 2.443452535530e-03f },
        { -9.576404037071e-09f, 4.999997381394e-01f, 3.989394690912e-01f, -1.361088824677e-05f, -6.650311013984e-02f, 1.723142818647e-04f, 1.081583059733e-02f, 1.613672977016e-03f },
        { -7.195420213920e-09f, 4.999997276127e-01f, 3.989379084370e-01f, -3.830634115627e-05f, -6.668526456987e-02f, -5.515603792405e-04f, 9.310188955174e-03f, 3.211354854276e-04f },
        { -2.859816836137e-09f, 4.999998610046e-01f, 3.989394001748e-01f, -3.291085714172e-05f, -6.671327351994e-02f, -8.841724926573e-04f, 8.146603138795e-03f, -1.138914087431e-03f },
        { 4.994990547046e-08f, 5.000021555626e-01f, 3.989804969370e-01f, 3.529478236079e-04f, -6.474172930203e-02f, 4.040717037798e-03f, 1.120742485726e-02f, -6.987674470520e-03f },
        { 1.608272645912e-08f, 5.000007921638e-01f, 3.989583601398e-01f, 1.706164762528e-04f, -6.551541468914e-02f, 2.609397382102e-03f, 1.089234048575e-02f, -6.197989919293e-03f },
        { 3.098648299879e-09f, 5.000001905695e-01f, 3.989470199084e-01f, 6.057534486303e-05f, -6.608155561608e-02f, 1.238807631840e-03f, 1.009091869192e-02f, -5.149754715909e-03f },
        { 2.311257939774e-09f, 5.000001274107e-01f, 3.989451296148e-01f, 3.233142084669e-05f, -6.630695432496e-02f, 3.392608908463e-04f, 8.875495981357e-03f, -4.053292165216e-03f },
        { 1.276799154310e-10f, 5.000000030923e-01f, 3.989421898267e-01f, -4.571645233225e-06f, -6.656494064804e-02f, -5.934317018323e-04f, 7.689123933462e-03f, -3.099480684097e-03f },
        { -8.078536305466e-10f, 4.999999408116e-01f, 3.989404726197e-01f, -2.957004303604e-05f, -6.676595004097e-02f, -1.421416370823e-03f, 6.474568556247e-03f, -2.270812338512e-03f },
        { -3.222436502261e-10f, 4.999999702352e-01f, 3.989411323755e-01f, -2.369738877525e-05f, -6.676730919034e-02f, -1.752037304553e-03f, 5.102313963482e-03f, -1.537730608098e-03f },
        { -2.594553278911e-10f, 4.999999737066e-01f, 3.989411725309e-01f, -2.485435609361e-05f, -6.680389850372e-02f, -2.116704296951e-03f, 3.885401294199e-03f, -9.790070649423e-04f },
        { -1.047266517934e-10f, 4.999999871204e-01f, 3.989416237894e-01f, -1.775783773154e-05f, -6.675908940270e-02f, -2.159311486117e-03f, 2.723254072169e-03f, -5.561369843300e-04f },
        { -1.861257361219e-11f, 4.999999969017e-01f, 3.989420659100e-01f, -7.904985655287e-06f, -6.665399684553e-02f, -1.804384357906e-03f, 1.669027692303e-03f, -2.638180213839e-04f },
        { -2.861005947811e-12f, 4.999999993324e-01f, 3.989422158961e-01f, -3.304974886380e-06f, -6.658511902144e-02f, -1.441470739192e-03f, 8.682231141649e-04f, -9.721720324502e-05f },
        { -6.931081848437e-14f, 4.999999999693e-01f, 3.989422747692e-01f, -5.445991205736e-07f, -6.651966412573e-02f, -8.296820867817e-04f, 3.019062525765e-04f, -2.021254892238e-05f },
        { 2.488540932739e-17f, 5.000000000000e-01f, 3.989422803427e-01f, -2.517239492518e-08f, -6.649472014558e-02f, -3.379370007141e-04f, 2.952112069731e-05f, -6.644277939862e-07f },
        { 5.109672840433e-17f, 5.000000000000e-01f, 3.989422803851e-01f, 1.278547761547e-08f, -6.649339853522e-02f, 2.909495319320e-04f, 3.855034666595e-05f, 1.014201310645e-06f },
        { -1.136991692117e-13f, 5.000000000468e-01f, 3.989422725036e-01f, 7.012579562103e-07f, -6.652495995394e-02f, 8.989530654902e-04f, 3.376668702723e-04f, 2.375382812729e-05f },
        { -4.172528467550e-12f, 5.000000009152e-01f, 3.989421973275e-01f, 3.995488092711e-06f, -6.659778921110e-02f, 1.530793260877e-03f, 9.278807152159e-04f, 1.067766328292e-04f },
        { -1.147780115968e-11f, 5.000000021122e-01f, 3.989421203520e-01f, 6.402957339332e-06f, -6.663321933184e-02f, 1.687286774730e-03f, 1.701693911086e-03f, 2.753669185698e-04f },
        { -8.661906493892e-11f, 5.000000108731e-01f, 3.989417126888e-01f, 1.578532951572e-05f, -6.673704503275e-02f, 2.057326381411e-03f, 2.762368600013e-03f, 5.735816127318e-04f },
        { -2.147153192866e-10f, 5.000000222624e-01f, 3.989413180377e-01f, 2.221589180438e-05f, -6.677965052501e-02f, 2.022649777541e-03f, 3.928794996444e-03f, 1.002687336982e-03f },
        { -1.553798379383e-10f, 5.000000175453e-01f, 3.989414907543e-01f, 1.842294172046e-05f, -6.672809086353e-02f, 1.630527958664e-03f, 5.135830304921e-03f, 1.564938642279e-03f },
        { -5.996243796492e-10f, 5.000000456364e-01f, 3.989408272824e-01f, 2.488019416360e-05f, -6.673416372131e-02f, 1.327566047812e-03f, 6.520700148741e-03f, 2.306884619634e-03f },
        { 1.968823136777e-12f, 5.000000033680e-01f, 3.989420651685e-01f, 5.589588032365e-06f, -6.656645085691e-02f, 5.698391047198e-04f, 7.778805824653e-03f, 3.155436353461e-03f },
        { 1.924890461806e-09f, 4.999998908978e-01f, 3.989447973227e-01f, -2.961286332385e-05f, -6.631433790128e-02f, -3.608742731856e-04f, 8.982688956636e-03f, 4.125091511497e-03f },
        { 5.015787400439e-09f, 4.999997199453e-01f, 3.989486977031e-01f, -7.643222387434e-05f, -6.600523117668e-02f, -1.394854882198e-03f, 1.012367828922e-02f, 5.205601130101e-03f },
        { 2.405834679315e-08f, 4.999988764917e-01f, 3.989638518939e-01f, -2.158932917255e-04f, -6.533119112006e-02f, -2.892812150475e-03f, 1.082150532789e-02f, 6.214666802772e-03f },
        { 3.143106614769e-10f, 4.999999830367e-01f, 3.989426780867e-01f, -5.293448343867e-06f, -6.644658843201e-02f, -2.308318421913e-04f, 1.073208574223e-02f, -1.426211982512e-03f },
        { 1.096641436168e-08f, 4.999996790480e-01f, 3.989462926820e-01f, -2.826542005576e-05f, -6.636382480049e-02f, -3.938919152643e-04f, 1.088050499867e-02f, -1.457760767989e-03f },
        { -2.850443445807e-08f, 5.000008054187e-01f, 3.989327427988e-01f, 6.025299206992e-05f, -6.669958622366e-02f, 3.325195128332e-04f, 1.008031523197e-02f, -1.143427823106e-03f },
        { 3.005225707397e-08f, 4.999991146140e-01f, 3.989536904803e-01f, -8.408531070445e-05f, -6.610224308527e-02f, -1.152150777465e-03f, 1.213214660434e-02f, -2.359666688534e-03f },
        { 7.414581956340e-07f, 4.999831243295e-01f, 3.991077044585e-01f, -9.080987622433e-04f, -6.345738486438e-02f, -6.245031156953e-03f, 1.757957725397e-02f, -4.856441472341e-03f },
        { 1.148900493290e-06f, 4.999764881457e-01f, 3.991500158422e-01f, -1.031698015207e-03f, -6.335379458853e-02f, -5.943270330528e-03f, 1.678106157438e-02f, -4.297104408185e-03f },
        { 3.872153156504e-06f, 4.999293375408e-01f, 3.994976559953e-01f, -2.444671242991e-03f, -5.994070563675e-02f, -1.083110152289e-02f, 2.061045905088e-02f, -5.556897841520e-03f },
        { -2.719087436239e-06f, 5.000426022772e-01f, 3.986616274853e-01f, 9.912068560983e-04f, -6.843154948826e-02f, 1.785382622465e-03f, 1.017406808140e-02f, -1.849639761702e-03f },
        { -1.003226039649e-05f, 5.001459992013e-01f, 3.980399643106e-01f, 3.048013125775e-03f, -7.246629565947e-02f, 6.462496394716e-03f, 7.221939761620e-03f, -1.072865792132e-03f },
        { 6.368216345315e-06f, 4.999090908549e-01f, 3.995087469236e-01f, -2.018000411443e-03f, -6.196836581926e-02f, -6.606487250700e-03f, 1.627152942662e-02f, -3.761503138466e-03f },
        { -6.287419962186e-06f, 5.000720276380e-01f, 3.986081513227e-01f, 7.523344208545e-04f, -6.709059624647e-02f, -9.138163467254e-04f, 1.275040118541e-02f, -2.826417786738e-03f },
        { -1.111423300434e-05f, 5.001207814979e-01f, 3.984040208567e-01f, 1.203820638022e-03f, -6.764089116750e-02f, -5.758996516592e-04f, 1.268666674480e-02f, -2.842283716404e-03f },
        { 6.462120495621e-07f, 4.999874353893e-01f, 3.990529000497e-01f, -5.526193834314e-04f, -6.478482496365e-02f, -3.365395466151e-03f, 1.420176389464e-02f, -3.195278779811e-03f },
        { -1.607199150967e-05f, 5.001599869960e-01f, 3.982895139251e-01f, 1.324005967252e-03f, -6.755335967359e-02f, -9.142557788905e-04f, 1.299585612825e-02f, -2.940953698183e-03f },
        { -5.688785505390e-05f, 5.005403714585e-01f, 3.967695287014e-01f, 4.699854206775e-03f, -7.205402574450e-02f, 2.687550764334e-03f, 1.139375809937e-02f, -2.635407037174e-03f },
        { -1.354841591032e-04f, 5.012174340325e-01f, 3.942692584359e-01f, 9.830638603137e-03f, -7.837298828725e-02f, 7.358182894668e-03f, 9.475300606337e-03f, -2.297596302175e-03f },
        { -3.880876201135e-04f, 5.032009688600e-01f, 3.875898480919e-01f, 2.233439731641e-02f, -9.242610883075e-02f, 1.684097363036e-02f, 5.918101601258e-03f, -1.725346980659e-03f },
        { -1.038034674470e-03f, 5.078103454978e-01f, 3.735705779668e-01f, 4.603914968048e-02f, -1.164918468334e-01f, 3.151061462192e-02f, 9.467443267241e-04f, -1.002804517335e-03f },
        { -2.288781177654e-03f, 5.158589402656e-01f, 3.513617429805e-01f, 8.010280662879e-02f, -1.478565076131e-01f, 4.884760857386e-02f, -4.380062141764e-03f, -3.010015177711e-04f },
        { 3.085042016063e-02f, 3.643276782232e-02f, 4.302523480341e-02f, 5.081060102039e-02f, 6.000472020315e-02f, 7.086250456305e-02f, 8.368499237971e-02f, 9.882769445952e-02f },
        { 3.259233357021e-04f, 5.010754162635e-01f, 3.871345495421e-01f, 3.208547506871e-02f, -1.092486590556e-01f, 3.025603414154e-02f, 5.837616363284e-04f, -8.677367719252e-04f },
        { 9.540664416671e-04f, 4.988550685342e-01f, 3.893156192859e-01f, 3.342210589752e-02f, -1.137534505824e-01f, 3.408718245032e-02f, -8.883930610507e-04f, -6.473519130032e-04f },
        { 1.818107402367e-03f, 4.958997984906e-01f, 3.921984870698e-01f, 3.480113876404e-02f, -1.187406265894e-01f, 3.821213219074e-02f, -2.416531649431e-03f, -4.273809487399e-04f },
        { 3.675086272510e-02f, 3.836848431998e-01f, 5.259938981114e-01f, -2.354433568438e-02f, -1.343283964550e-01f, 6.442272197853e-02f, -1.237799926690e-02f, 8.959186455973e-04f },
    };

    int seg = 0;
    for (int i = 1; i < 80; i++) {
        if (x >= breakpoints[i]) seg = i;
    }

    float result = coeffs[seg][7];
    result = result * x + coeffs[seg][6];
    result = result * x + coeffs[seg][5];
    result = result * x + coeffs[seg][4];
    result = result * x + coeffs[seg][3];
    result = result * x + coeffs[seg][2];
    result = result * x + coeffs[seg][1];
    result = result * x + coeffs[seg][0];

    return static_cast<std::bfloat16_t>(result);
}
