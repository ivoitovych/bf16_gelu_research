// ============================================================================
// DOPRI FULL-RANGE POLYNOMIAL APPROXIMATION
// ============================================================================
//
// Pure DOPRI polynomial segments covering entire bfloat16 range
// Range: [-13.5625, 2.78125] (no saturation/underflow)
// No mixing with Taylor series or asymptotic expansion
//
// Generated by generate_dopri_full_range.py
// ============================================================================

/**
 * @brief DOPRI Full Range Deg7 Seg96
 *
 * Pure DOPRI polynomial approximation for FULL bfloat16 range
 * Degree: 7, Segments: 96
 * Range: [-13.5625, 2.78125]
 * No mixing with other methods - pure polynomial only
 */
std::bfloat16_t gelu_dopri_full_range_deg7_seg96(std::bfloat16_t x_bf16) {
    float x = static_cast<float>(x_bf16);

    // Saturation check
    if (x >= 2.78125f) {
        return static_cast<std::bfloat16_t>(x);
    }

    constexpr float breakpoints[] = {
        -13.56250000f, -11.75298775f, -11.21898700f, -10.26629090f, -9.39845055f,
        -8.51874490f, -7.64025360f, -6.76167006f, -5.88420050f, -5.61653680f,
        -5.61653680f, -4.92010406f, -3.78221813f, -3.78221813f, -3.67193179f,
        -3.56203422f, -3.45821149f, -3.31619034f, -3.19238004f, -3.06611303f,
        -2.94353962f, -2.82460412f, -2.70958684f, -2.59860874f, -2.49166569f,
        -2.38872851f, -2.28971055f, -0.29085151f, -0.27361410f, -0.25772557f,
        -0.24284075f, -0.22880169f, -0.21545724f, -0.20277133f, -0.19063884f,
        -0.17890595f, -0.16766463f, -0.15673116f, -0.14608793f, -0.13582032f,
        -0.12572028f, -0.11585334f, -0.10617472f, -0.09669863f, -0.08735484f,
        -0.07813958f, -0.06903885f, -0.06003548f, -0.05111550f, -0.04226504f,
        -0.03347088f, -0.02472028f, -0.01600437f, -0.00730221f, 0.00139266f,
        0.00267462f, 0.02411185f, 0.02579468f, 0.03671632f, 0.04514514f,
        0.05411582f, 0.06310441f, 0.07219494f, 0.08139558f, 0.09073811f,
        0.10023357f, 0.10988991f, 0.11973567f, 0.12978974f, 0.14008399f,
        0.15071827f, 0.16159896f, 0.17282455f, 0.18455306f, 0.19663547f,
        0.20932644f, 0.22257664f, 0.23662972f, 0.25143354f, 0.26728662f,
        0.28437694f, 0.30298396f, 0.32343427f, 0.34623459f, 0.37225629f,
        0.40267815f, 0.43917776f, 0.48510285f, 0.54605458f, 0.63164882f,
        0.75518486f, 0.92443546f, 1.16365102f, 1.67423573f, 2.27465605f,
        2.54165406f, 2.78125000f
    };

    constexpr float coeffs[96][8] = {
        { 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f },
        { 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f },
        { 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f },
        { 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f },
        { 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f, 0.000000000000e+00f },
        { -1.604336509751e-10f, 3.446307895130e-10f, -3.639572879503e-10f, -3.077638857832e-10f, -8.225449534924e-11f, -1.046568925946e-11f, -6.534778280931e-13f, -1.617223297650e-14f },
        { -6.230842830357e-06f, 3.867596221058e-06f, 5.557472448822e-06f, 2.157997013703e-06f, 4.152114234959e-07f, 4.378173005649e-08f, 2.432292548266e-09f, 5.592791588954e-11f },
        { -5.286879684442e-04f, 2.261477249929e-04f, 4.685357572121e-04f, 2.128865360703e-04f, 4.694396621204e-05f, 5.637790842534e-06f, 3.557997414567e-07f, 9.281901665469e-09f },
        { -1.099381088018e-04f, 1.548713987608e-04f, -7.755801839142e-05f, -1.485437983505e-04f, -6.026615373177e-05f, -1.105536897546e-05f, -9.785458081251e-07f, -3.407638982183e-08f },
        { -1.704227739407e-18f, 9.571857811740e-18f, -5.376069163145e-17f, 3.019489028712e-16f, -1.695907124301e-15f, 9.525124770798e-15f, -5.349821378732e-14f, 3.004746864008e-13f },
        { -2.801459933868e-02f, 4.651040411238e-03f, 2.414422553414e-02f, 1.378467806759e-02f, 3.673508448590e-03f, 5.276524044046e-04f, 3.967345033908e-05f, 1.231093630850e-06f },
        { -1.738086220223e+00f, -2.419948174269e+00f, -1.453242495848e+00f, -4.877440722632e-01f, -9.876815200872e-02f, -1.206269452023e-02f, -8.224107651525e-04f, -2.413747354950e-05f },
        { -4.038536515060e-09f, 1.307012881345e-08f, -4.109548195451e-08f, 1.238957020884e-07f, -3.493261657970e-07f, 8.700910907696e-07f, -1.584619096577e-06f, -4.603600363893e-07f },
        { -7.865133637596e-02f, 5.255824746214e-02f, 1.940557787551e-02f, -6.019211088922e-02f, -4.590797116399e-02f, -1.349127720881e-02f, -1.837258991313e-03f, -9.697016734600e-05f },
        { -9.557341037849e-02f, 5.956903008984e-02f, 2.715324110540e-02f, -6.941432374458e-02f, -5.561144151044e-02f, -1.686111257848e-02f, -2.360525761393e-03f, -1.279431630773e-04f },
        { -1.135021740121e-01f, 6.571856716472e-02f, 3.609624783464e-02f, -7.800643904062e-02f, -6.569044110891e-02f, -2.053752992707e-02f, -2.954059512613e-03f, -1.643350141494e-04f },
        { -1.354461971281e-01f, 7.147458036333e-02f, 4.794152590162e-02f, -8.680899003147e-02f, -7.762565258442e-02f, -2.514632153691e-02f, -3.731336282239e-03f, -2.138881063467e-04f },
        { -1.596997445564e-01f, 7.538890289769e-02f, 6.202549169293e-02f, -9.411372410489e-02f, -9.008108541144e-02f, -3.032224624086e-02f, -4.652399487059e-03f, -2.754359398699e-04f },
        { -1.819454743649e-01f, 7.638368354157e-02f, 7.567290417987e-02f, -9.812825506345e-02f, -1.003974425215e-01f, -3.501126483703e-02f, -5.538666547080e-03f, -3.377554697356e-04f },
        { -2.022515795280e-01f, 7.454331406304e-02f, 8.854174539439e-02f, -9.882012114716e-02f, -1.082270241826e-01f, -3.902721853058e-02f, -6.353439020964e-03f, -3.983743713937e-04f },
        { -2.190554598366e-01f, 7.016250895683e-02f, 9.919094411337e-02f, -9.615540150354e-02f, -1.125001022597e-01f, -4.177364125435e-02f, -6.969427106193e-03f, -4.475559100522e-04f },
        { -2.898981863945e-01f, 1.795818253875e-03f, 1.318155491185e-01f, -1.977380845003e-02f, -6.694788054259e-02f, -2.852123291159e-02f, -5.024458267520e-03f, -3.319396452933e-04f },
        { -2.296371034472e-01f, 6.834375119095e-02f, 1.068823430270e-01f, -9.574337681337e-02f, -1.173607950587e-01f, -4.464045482457e-02f, -7.617478516607e-03f, -5.008425233042e-04f },
        { -1.761446177977e-01f, 1.343382954802e-01f, 9.301070498207e-02f, -1.623536788911e-01f, -1.651919525017e-01f, -6.080877639705e-02f, -1.034887892507e-02f, -6.871587188929e-04f },
        { -1.312824861692e-01f, 1.958041864043e-01f, 8.940034272807e-02f, -2.166194155286e-01f, -2.077607650646e-01f, -7.606262590024e-02f, -1.305865340861e-02f, -8.808860201530e-04f },
        { -9.551575878477e-02f, 2.501766010094e-01f, 9.447051928492e-02f, -2.571124290750e-01f, -2.431191685799e-01f, -8.956234551206e-02f, -1.558645290037e-02f, -1.070557956865e-03f },
        { -9.387149462482e-04f, 4.907515717334e-01f, 3.625190746318e-01f, -7.480657282022e-02f, -1.535676203969e-01f, -5.714598344187e-02f, -8.183089947897e-03f, -3.166916893052e-04f },
        { -7.822175888116e-08f, 4.999992197208e-01f, 3.989467489998e-01f, 1.061901345018e-04f, -6.580207852293e-02f, 2.258104150753e-03f, 1.398625277620e-02f, 3.573071858276e-03f },
        { -1.284611512574e-06f, 4.999725132182e-01f, 3.987044791103e-01f, -1.030417433261e-03f, -6.859892061925e-02f, -6.321722853389e-04f, 1.475135719709e-02f, 6.391524267469e-03f },
        { -3.807749550138e-08f, 4.999994801690e-01f, 3.989424973560e-01f, 4.486218749116e-05f, -6.612713842165e-02f, 1.386197449883e-03f, 1.280533864480e-02f, 2.933277860331e-03f },
        { 9.226923644516e-07f, 5.000229000877e-01f, 3.991764252735e-01f, 1.251062753986e-03f, -6.288861271568e-02f, 4.894813749578e-03f, 1.112941376693e-02f, -2.074529121311e-03f },
        { 1.886092757133e-06f, 5.000494148702e-01f, 3.994745808513e-01f, 2.983324533861e-03f, -5.758958071018e-02f, 1.189832710020e-02f, 9.906556383934e-03f, -1.085214892272e-02f },
        { 1.323877579079e-06f, 5.000369143819e-01f, 3.993657520622e-01f, 2.530713807656e-03f, -5.841463918779e-02f, 1.168483748826e-02f, 1.054183597751e-02f, -1.128185911760e-02f },
        { 8.989391954194e-07f, 5.000267001195e-01f, 3.992687508561e-01f, 2.082037279451e-03f, -5.937941824663e-02f, 1.113544979867e-02f, 1.115709499780e-02f, -1.137465322448e-02f },
        { 5.769565790358e-07f, 5.000183506815e-01f, 3.991826966229e-01f, 1.644735964466e-03f, -6.044727083609e-02f, 1.028928406063e-02f, 1.171781765190e-02f, -1.119956979637e-02f },
        { 3.749090149858e-07f, 5.000126800315e-01f, 3.991190179858e-01f, 1.287553821989e-03f, -6.144141401353e-02f, 9.249625831895e-03f, 1.205767383781e-02f, -1.071512534303e-02f },
        { 2.399861181077e-07f, 5.000086145096e-01f, 3.990697535361e-01f, 9.865374711931e-04f, -6.237400296950e-02f, 8.072782922553e-03f, 1.219441678982e-02f, -1.001949225638e-02f },
        { 1.355503905538e-07f, 5.000052460572e-01f, 3.990260108524e-01f, 6.994648939281e-04f, -6.333458566434e-02f, 6.732906337224e-03f, 1.222968944878e-02f, -9.232048105175e-03f },
        { 8.313978740782e-08f, 5.000034034682e-01f, 3.989997192222e-01f, 5.072006392058e-04f, -6.407212680435e-02f, 5.452930074317e-03f, 1.192502110694e-02f, -8.263090499035e-03f },
        { 3.676598472254e-08f, 5.000016646592e-01f, 3.989733616403e-01f, 3.037615327962e-04f, -6.488634536471e-02f, 4.013703252194e-03f, 1.161588685590e-02f, -7.338162252693e-03f },
        { 1.761420231539e-08f, 5.000008601866e-01f, 3.989595925899e-01f, 1.821627295703e-04f, -6.545761129661e-02f, 2.747621433908e-03f, 1.097538245446e-02f, -6.313216401160e-03f },
        { 5.031398280046e-09f, 5.000002844351e-01f, 3.989488697746e-01f, 7.928584253602e-05f, -6.598159070183e-02f, 1.488947512908e-03f, 1.024294215042e-02f, -5.335036967577e-03f },
        { 4.304703607160e-09f, 5.000002284855e-01f, 3.989472150367e-01f, 5.451711267197e-05f, -6.618116453486e-02f, 6.808066536881e-04f, 9.131934909393e-03f, -4.308809544032e-03f },
        { 9.899928816933e-10f, 5.000000527171e-01f, 3.989433675990e-01f, 1.014016216377e-05f, -6.646363923593e-02f, -2.370437529222e-04f, 8.123441727123e-03f, -3.436395455509e-03f },
        { -1.156482666732e-09f, 4.999999237993e-01f, 3.989401989567e-01f, -3.030002624412e-05f, -6.674157249528e-02f, -1.172067912474e-03f, 7.143322155131e-03f, -2.680173240979e-03f },
        { -6.650047712198e-10f, 4.999999477725e-01f, 3.989405706482e-01f, -2.993515145464e-05f, -6.678771829298e-02f, -1.614848483947e-03f, 5.954859298797e-03f, -1.971808743582e-03f },
        { -5.963525852359e-10f, 4.999999485703e-01f, 3.989404436652e-01f, -3.476793462051e-05f, -6.685872803246e-02f, -2.083948677326e-03f, 4.875305255217e-03f, -1.401613677619e-03f },
        { -7.504451835959e-11f, 4.999999900282e-01f, 3.989417472822e-01f, -1.483469133465e-05f, -6.671864486192e-02f, -1.854846149102e-03f, 3.649151027424e-03f, -9.037202518532e-04f },
        { -1.313017235148e-10f, 4.999999842937e-01f, 3.989415039767e-01f, -2.028071993720e-05f, -6.678525985321e-02f, -2.261643079409e-03f, 2.786554961570e-03f, -5.717811244604e-04f },
        { -2.042617797343e-11f, 4.999999966766e-01f, 3.989420551277e-01f, -8.142799686220e-06f, -6.665593418857e-02f, -1.796064082342e-03f, 1.827442601259e-03f, -3.047926168421e-04f },
        { -1.348848231825e-12f, 4.999999995827e-01f, 3.989422324968e-01f, -2.747870193789e-06f, -6.657538087014e-02f, -1.361496756149e-03f, 1.076837773005e-03f, -1.382718356285e-04f },
        { -2.044956217366e-12f, 4.999999994521e-01f, 3.989422206826e-01f, -3.370741773668e-06f, -6.659334607824e-02f, -1.588487642104e-03f, 6.052933596452e-04f, -5.307933825878e-05f },
        { -4.853877431506e-14f, 4.999999999751e-01f, 3.989422752570e-01f, -5.451671372897e-07f, -6.652138172249e-02f, -8.870137541879e-04f, 1.954890809020e-04f, -9.895217120925e-06f },
        { -1.180358596827e-17f, 5.000000000000e-01f, 3.989422803987e-01f, -1.769381992308e-09f, -6.649118735771e-02f, -1.580999629442e-04f, 9.580853206140e-06f, -1.476325549987e-07f },
        { 6.779422946611e-15f, 4.999999999860e-01f, 3.989422913806e-01f, -3.768706626056e-06f, -6.601061569411e-02f, -6.711763736980e-04f, -4.136339572429e-06f, -2.002253537069e-08f },
        { 2.610192266792e-16f, 4.999999999998e-01f, 3.989422804432e-01f, -4.006782853084e-09f, -6.649022124487e-02f, -1.112866857213e-06f, 9.907576846391e-03f, 9.242157140465e-04f },
        { 2.005360321495e-10f, 4.999999642244e-01f, 3.989447865303e-01f, -8.547245793974e-05f, -6.509690073782e-02f, -8.060379902895e-03f, -6.011797804479e-04f, -3.493169117487e-05f },
        { -4.587360719241e-13f, 5.000000003191e-01f, 3.989422356322e-01f, 2.754709686763e-06f, -6.657708958074e-02f, 1.374923986727e-03f, 1.224888624329e-03f, 1.695028563110e-04f },
        { 6.714155047918e-12f, 5.000000000924e-01f, 3.989422089021e-01f, 4.470568412469e-06f, -6.661137201900e-02f, 1.562905596902e-03f, 2.039619786845e-03f, 3.709458434700e-04f },
        { -9.583473952573e-11f, 5.000000117708e-01f, 3.989416796053e-01f, 1.631732971616e-05f, -6.673928062529e-02f, 2.026058176053e-03f, 3.031967838823e-03f, 6.661038258624e-04f },
        { -1.123657953340e-10f, 5.000000134373e-01f, 3.989416232536e-01f, 1.690450530726e-05f, -6.673266960765e-02f, 1.845820679295e-03f, 4.017386269437e-03f, 1.051206698308e-03f },
        { -4.764111696250e-10f, 5.000000411529e-01f, 3.989407985034e-01f, 2.851781933556e-05f, -6.680079053140e-02f, 1.829948914978e-03f, 5.205809207799e-03f, 1.577854264054e-03f },
        { -1.241283979342e-09f, 5.000000877968e-01f, 3.989397165023e-01f, 3.958730682926e-05f, -6.683274453502e-02f, 1.603993874088e-03f, 6.449836916573e-03f, 2.231741999226e-03f },
        { -1.777300377809e-09f, 5.000001076029e-01f, 3.989396123895e-01f, 3.468715243644e-05f, -6.674241905784e-02f, 1.024725226177e-03f, 7.629733454153e-03f, 2.987122302294e-03f },
        { 3.346108016942e-09f, 4.999998212097e-01f, 3.989461003242e-01f, -4.045620116901e-05f, -6.628677366807e-02f, -2.433371216588e-04f, 8.450312322473e-03f, 3.740070043583e-03f },
        { 5.592522573579e-09f, 4.999997044422e-01f, 3.989486749813e-01f, -7.151553779048e-05f, -6.607001647193e-02f, -1.059066507616e-03f, 9.577823657132e-03f, 4.711712090688e-03f },
        { 1.226661170026e-08f, 4.999993839724e-01f, 3.989550188926e-01f, -1.374853185109e-04f, -6.569397090001e-02f, -2.134984505343e-03f, 1.053346642428e-02f, 5.738027097363e-03f },
        { 2.620757971705e-08f, 4.999987716869e-01f, 3.989660177042e-01f, -2.400350352509e-04f, -6.518004735095e-02f, -3.378431050748e-03f, 1.131989099156e-02f, 6.803565386211e-03f },
        { 4.150605831470e-08f, 4.999981133973e-01f, 3.989775972338e-01f, -3.457852229485e-04f, -6.466042174534e-02f, -4.611395632273e-03f, 1.205875136813e-02f, 7.952255890789e-03f },
        { 9.480786111849e-08f, 4.999961365349e-01f, 3.990072175799e-01f, -5.715227864081e-04f, -6.377032586056e-02f, -6.150836056155e-03f, 1.234101156379e-02f, 8.952413310114e-03f },
        { 1.825666325707e-07f, 4.999931662684e-01f, 3.990477675188e-01f, -8.522149253379e-04f, -6.277244513783e-02f, -7.666316481434e-03f, 1.243200793882e-02f, 9.895717276190e-03f },
        { 2.928502959228e-07f, 4.999896688355e-01f, 3.990925318282e-01f, -1.142972821625e-03f, -6.180169703538e-02f, -9.046095923270e-03f, 1.244917450932e-02f, 1.082201073782e-02f },
        { 5.034603319443e-07f, 4.999835431660e-01f, 3.991639358292e-01f, -1.559986624634e-03f, -6.058447196426e-02f, -1.042123704003e-02f, 1.210844069198e-02f, 1.150517331001e-02f },
        { 7.787240210873e-07f, 4.999760788377e-01f, 3.992449123999e-01f, -1.998611684437e-03f, -5.940727272634e-02f, -1.159679232571e-02f, 1.168505604004e-02f, 1.207500583932e-02f },
        { 1.199905810639e-06f, 4.999654816057e-01f, 3.993510016659e-01f, -2.523302707009e-03f, -5.815479136462e-02f, -1.258315884297e-02f, 1.106053167664e-02f, 1.237647441534e-02f },
        { 1.788586983158e-06f, 4.999517234354e-01f, 3.994782698530e-01f, -3.098772262718e-03f, -5.693393964509e-02f, -1.330738420365e-02f, 1.033965780867e-02f, 1.241611523477e-02f },
        { -4.970846816802e-07f, 5.000124064426e-01f, 3.988161063638e-01f, 6.543284612023e-04f, -6.819192965323e-02f, 1.384662486224e-03f, 1.266547578721e-02f, -5.296567314572e-03f },
        { 2.501616761250e-06f, 4.999404118102e-01f, 3.995258592458e-01f, -2.973897012313e-03f, -5.841796833254e-02f, -9.859289286554e-03f, 1.016517164559e-02f, 6.872416457018e-03f },
        { -4.019106749523e-07f, 5.000084390279e-01f, 3.988728971588e-01f, 2.608480023199e-04f, -6.675920696072e-02f, -1.191282100243e-03f, 1.418802866565e-02f, -4.597491263179e-03f },
        { 6.361333907009e-07f, 4.999858432569e-01f, 3.990751555038e-01f, -6.802370534011e-04f, -6.443869636729e-02f, -3.692197189627e-03f, 1.390365481186e-02f, -2.607833091002e-03f },
        { 4.281068510258e-07f, 4.999902096169e-01f, 3.990387467295e-01f, -5.335000995462e-04f, -6.468443780924e-02f, -3.820774075869e-03f, 1.490435333936e-02f, -3.584291358371e-03f },
        { -6.425214053567e-07f, 5.000095025828e-01f, 3.988986626733e-01f, -2.780275042989e-05f, -6.552731815356e-02f, -3.697535273049e-03f, 1.637571389863e-02f, -4.993922116872e-03f },
        { 9.631452543722e-07f, 4.999802626009e-01f, 3.991168934664e-01f, -8.689547061297e-04f, -6.383729738251e-02f, -5.074896651577e-03f, 1.590843307260e-02f, -3.918808420236e-03f },
        { 1.419647471645e-06f, 4.999726762809e-01f, 3.991695351095e-01f, -1.064729938746e-03f, -6.342304412346e-02f, -5.556671275740e-03f, 1.616942906013e-02f, -3.952731168929e-03f },
        { 1.886189765877e-06f, 4.999656189138e-01f, 3.992137094715e-01f, -1.210606626967e-03f, -6.315744002408e-02f, -5.802212890925e-03f, 1.624441598586e-02f, -3.932986899740e-03f },
        { 2.251100573161e-06f, 4.999608730516e-01f, 3.992375946273e-01f, -1.263751656120e-03f, -6.313462052271e-02f, -5.680049218143e-03f, 1.601937858681e-02f, -3.811094227602e-03f },
        { 1.970421569215e-06f, 4.999676169220e-01f, 3.991759709323e-01f, -9.705445359078e-04f, -6.393836495203e-02f, -4.394293256238e-03f, 1.489944155355e-02f, -3.399323158504e-03f },
        { 1.427183597873e-06f, 4.999761927629e-01f, 3.991182605077e-01f, -7.557799410272e-04f, -6.441600006456e-02f, -3.759143684933e-03f, 1.443164066999e-02f, -3.252058060922e-03f },
        { 1.191477956633e-06f, 4.999789606097e-01f, 3.991044132053e-01f, -7.175644960822e-04f, -6.447873788874e-02f, -3.697999092673e-03f, 1.439897511412e-02f, -3.244708066063e-03f },
        { -1.075848939372e-05f, 5.001068490603e-01f, 3.985170983494e-01f, 7.828697250709e-04f, -6.678187356321e-02f, -1.573754533243e-03f, 1.330885807218e-02f, -3.004578902210e-03f },
        { -1.297404302012e-04f, 5.011723329414e-01f, 3.944203191643e-01f, 9.551038135213e-03f, -7.806434457263e-02f, 7.155171676594e-03f, 9.548888389869e-03f, -2.308919411540e-03f },
        { -1.102356736252e-03f, 5.082686560770e-01f, 3.721755336703e-01f, 4.839122776218e-02f, -1.188646649187e-01f, 3.294314723782e-02f, 4.674334688358e-04f, -9.342304923488e-04f },
        { -1.006611551659e-02f, 5.586873486989e-01f, 2.500832447517e-01f, 2.134429738742e-01f, -2.534296189566e-01f, 9.912305792337e-02f, -1.771531301824e-02f, 1.218965322578e-03f },
        { 1.944584841106e-02f, 4.542065170988e-01f, 4.053123358521e-01f, 8.918994401970e-02f, -1.965451833798e-01f, 8.474214196201e-02f, -1.601902806530e-02f, 1.172376137004e-03f },
        { 3.096742085926e-01f, -4.609590155878e-01f, 1.645014680829e+00f, -8.459933606765e-01f, 2.277378239062e-01f, -3.102446578216e-02f, 1.569935016510e-03f, 2.448260549168e-05f },
        { -1.057216457642e-01f, 6.010705132751e-01f, 4.850480458504e-01f, -1.447001624108e-01f, -2.559308806149e-02f, 2.361712869787e-02f, -4.940696985134e-03f, 3.547227385483e-04f },
    };

    // Find segment
    int seg = 0;
    for (int i = 1; i < 96; i++) {
        if (x >= breakpoints[i]) seg = i;
    }

    // Horner's method evaluation
    float result = coeffs[seg][7];
    result = result * x + coeffs[seg][6];
    result = result * x + coeffs[seg][5];
    result = result * x + coeffs[seg][4];
    result = result * x + coeffs[seg][3];
    result = result * x + coeffs[seg][2];
    result = result * x + coeffs[seg][1];
    result = result * x + coeffs[seg][0];

    return static_cast<std::bfloat16_t>(result);
}
